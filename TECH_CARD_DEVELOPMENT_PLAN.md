# 技術卡系統開發計畫 (起源方案二核心版)

> 更新日期：2026-01-22
> 狀態：**Phase 1-2 已完成，轉向方案二：昂貴組織交易邏輯**
> 理論基礎：《The Secret of Our Success》、《The WEIRDest People in the World》

---

## 一、資源邏輯重構：昂貴組織開發權衡

為了符合起源企劃書並優化遊戲策略，我們將資源產出調整為：

### 1.1 三軌道產出 (Resource Mapping)

| 投資類型 | 產出資源 | 用途 | 主題對應 |
| :--- | :--- | :--- | :--- |
| **大腦 (Brain)** | **AP (技術點)** | **解鎖/級技術路徑** | 智慧與文化累積 |
| **消化 (Guts)** | **能量 (Energy)** | 維持生命與下回預算 | 代謝能量效率 |
| **肌肉 (Muscle)** | **行動點 (Action Points)** | 掠奪、探索、防禦、解鎖行動 | 實體執行力 |

### 1.2 資源特性

- **AP (大腦產出)**：可跨回合累積，專門用於「技術樹」升級。
- **行動點 (肌肉產出)**：本回合使用，用於執行特定的「獵取」或「對抗」行動。
- **策略核心**：玩家必須決定是要透過大腦獲取「長期技術優勢」，還是透過肌肉獲得「短期競爭優勢」。

---

## 二、文化複雜度分數 (CCS) 系統

不再由大腦投資直接產生分數，分數改為反映「文化的深度與系統性」。

### 2.1 基礎積分 (Base Points)

每張解鎖的技術卡根據其等級提供分數：

- **Tier 1**: 1 分
- **Tier 2**: 2 分
- **Tier 3**: 3 分
- **Tier 4**: 5 分
- **Tier V**: 8-10 分

### 2.2 組合加成 (Combination Bonuses)

- **火與食** (火的控制 + 烹飪技術 + 食物保存): **+5 分**
- **狩獵專精** (石器製作 + 長矛狩獵 + 複雜工具): **+5 分**
- **社會結構** (語言 + 族群認同 + 社會規範): **+5 分**
- **知識體系** (民俗生物學 + 口語傳承 + 教學系統): **+7 分**

### 2.3 勝利條件

- **累積 30 文化複雜度分數 (CCS)** 即達成「盧比孔門檻」，獲勝。

---

## 三、技術路徑設計 (修正版)

維持原有四條路徑，但效果將嚴格對齊「方案二」的需求。

### 3.1 核心調整

- 除了解鎖被動加成，高階技術將顯著提升 CCS。
- 「教學系統」與「累積文化」將成為 CCS 爆發的關鍵點。

---

## 四、程式碼實作重點

### 4.1 CCS 計算函數

```javascript
function calculateCCS(player) {
    let score = 0;
    // 1. 基礎技術分
    player.unlockedTechs.forEach(id => {
        score += TECH_CARDS[id].ccsValue;
    });
    // 2. 組合加成
    score += checkComboBonuses(player);
    return score;
}
```

### 4.2 confirmInvest 重構

```javascript
confirmInvest() {
    // ...
    player.results = {
        ap: calcReward('brain', bids.brain), // 大腦 -> AP (用於技術)
        energy: calcReward('guts', bids.guts),
        actionPoints: calcReward('muscle', bids.muscle) // 肌肉 -> 行動點 (用於掠奪等)
    };
    // ...
}
```

---

## 五、開發進度追蹤 (Scheme 2)

### Phase 1：核心邏輯改版 [✓]

- [x] 修改 `TECH_CARDS` 加入 `ccsValue` 屬性。
- [x] 重構 `confirmInvest` 的資源產出映射（大腦→AP、肌肉→行動點）。
- [x] 實作 `calculateCCS()` 與組合加成 `checkComboBonuses()` 邏輯。
- [x] 30 CCS「盧比孔門檻」勝利條件。

### Phase 2：UI 同步 [進行中]

- [x] 介面中的 "Total Cards" 更名為 "Cultural Complexity (CCS)"。
- [x] 投資畫面更新預估產出標籤。
- [x] 結算畫面顯示 CCS 欄位。
- [ ] **投資畫面顯示已生效的技術效果**：在玩家投資決策前，清楚呈現當前已啟用的文化技術加成（如「烹飪技術: 消化回報 ×1.2」）。
- [ ] **個人結算畫面顯示潛在行動收益**：根據玩家的行動點數，預估若全部用於狩獵可獲得的能量點數。
- [ ] **回合結算畫面顯示下回合預期能量**：計算並顯示「保留能量 + 消化產出 + 行動收益」的總和。

### Phase 3：平衡與機制調整 [ ]

- [ ] **技術與環境事件的交互作用**：
  - 設計技術效果與環境事件的增益/抵銷機制。
  - 例如：「火的控制」可抵消「寒冬來臨」的負面效果。
  - 例如：「灌溉系統」在「乾季來臨」時提供額外加成。
- [ ] 調整 AP 獲取率與技術成本。
- [ ] 測試領先玩家是否容易被「拉開差距」。
- [ ] 測試 30 CCS 勝利門檻的遊戲時長是否合適。

---

## 六、待辦事項備註（來自 Gemini 開發進度）

> 以下為 2026-01-22 Gemini 開發時提出的改進建議，已整合至上方各階段：

1. **已生效的文化技術**：投資畫面應顯示當前玩家已解鎖且生效中的技術加成，幫助玩家做出更明智的投資決策。

2. **可獲得的能量點數**：個人結算畫面應預覽行動階段的潛在收益，讓玩家了解行動點的價值。

3. **下一回合可使用的能量點**：回合結算時應計算並顯示所有有效行動後的最終能量預估值。

4. **技術與環境條件交互**：需設計技術效果與環境事件之間的增益或抵銷機制，增加策略深度。
